# Values for mlflow
# Configure resources, ingress, and application-specific settings
replicaCount: 1

image:
  repository: larribas/mlflow
  tag: "2.8.1"
  pullPolicy: IfNotPresent

resources:
  requests:
    memory: 512Mi
    cpu: 250m
  limits:
    memory: 1Gi
    cpu: 500m

# PostgreSQL database for MLflow metadata
postgresql:
  enabled: true
  auth:
    postgresPassword: "{{ .Values.global.credentials.postgresMlflowPassword | default \"mlflow\" }}"
    username: mlflow
    database: mlflow
    # Note: Use global-secrets.yaml or set via --set global.credentials.postgresMlflowPassword=xxx
  primary:
    persistence:
      size: 20Gi

# MinIO configuration for artifact storage
minio:
  bucket: mlflow-artifacts
  accessKey: "{{ .Values.global.credentials.minioRootUser | default \"admin\" }}"
  secretKey: "{{ .Values.global.credentials.minioRootPassword | default \"minio123\" }}"
  # Note: Use global-secrets.yaml or set via --set global.credentials.minioRootPassword=xxx

ingress:
  enabled: true
  className: traefik
  annotations:
    kubernetes.io/ingress.class: traefik
    cert-manager.io/cluster-issuer: letsencrypt-dns
  hosts:
    - host: mlflow.theblacklodge.dev
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: mlflow-tls
      hosts:
        - mlflow.theblacklodge.dev
