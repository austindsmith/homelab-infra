version: "3.9"

networks:
  proxy:
    external: true

services:
  # --- Media server & companions ---
  plex:
    image: lscr.io/linuxserver/plex:latest
    labels:
          com.centurylinklabs.watchtower.enable: "true"
    container_name: plex
    networks: [proxy]
    ports:
      - "32400:32400"        # keep for Plex discovery/remote access
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
      - VERSION=docker
      - ADVERTISE_IP=https://plex.${DOMAIN},http://192.168.1.26:32400
    volumes:
      - /opt/appdata/plex:/config
      - /mnt/nas/media/Movies:/movies
      - /mnt/nas/media/TV:/tv
    restart: unless-stopped

  radarr:
    image: lscr.io/linuxserver/radarr
    labels:
          com.centurylinklabs.watchtower.enable: "true"
    container_name: radarr
    networks: [proxy]
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
    volumes:
      - /opt/appdata/radarr:/config
      - /mnt/nas/media/Downloads:/downloads
      - /mnt/nas/media/Movies:/movies
    restart: unless-stopped
    expose: ["7878"]          # NPM will reach via proxy network

  overseerr:
    image: lscr.io/linuxserver/overseerr:develop
    labels:
          com.centurylinklabs.watchtower.enable: "true"
    container_name: overseerr
    networks: [proxy]
    ports:
      - "5055:5055" 
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
    volumes:
      - /opt/appdata/overseerr:/config
      - /mnt/nas/media/Movies:/movies
      - /mnt/nas/media/TV:/shows
      - /mnt/nas/media/Downloads:/downloads
    restart: unless-stopped       # remove host ports

  sonarr:
    image: lscr.io/linuxserver/sonarr
    labels:
          com.centurylinklabs.watchtower.enable: "true"
    container_name: sonarr
    networks: [proxy]
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
    volumes:
      - /opt/appdata/sonarr:/config
      - /mnt/nas/media/Downloads:/downloads
      - /mnt/nas/media/TV:/tv
    restart: unless-stopped
    expose: ["8989"]

  lidarr:
    image: lscr.io/linuxserver/lidarr
    labels:
          com.centurylinklabs.watchtower.enable: "true"
    container_name: lidarr
    networks: [proxy]
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
    volumes:
      - /opt/appdata/lidarr:/config
      - /mnt/nas/media/Downloads:/downloads
      - /mnt/nas/media/Music:/music
    restart: unless-stopped
    expose: ["8686"]

  bazarr:
    image: lscr.io/linuxserver/bazarr
    labels:
          com.centurylinklabs.watchtower.enable: "true"
    container_name: bazarr
    networks: [proxy]
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
    volumes:
      - /opt/appdata/bazarr:/config
      - /mnt/nas/media/Movies:/movies
      - /mnt/nas/media/TV:/tv
    restart: unless-stopped
    expose: ["6767"]

  prowlarr:
    image: lscr.io/linuxserver/prowlarr
    labels:
          com.centurylinklabs.watchtower.enable: "true"
    container_name: prowlarr
    networks: [proxy]
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
    volumes:
      - /opt/appdata/prowlarr:/config
    restart: unless-stopped
    expose: ["9696"]

  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent
    container_name: qbittorrent
    networks: [proxy]
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
      - WEBUI_PORT=8080
    volumes:
      - /opt/appdata/qbittorrent:/config
      - /mnt/nas/media/Downloads:/downloads
    ports:
      - "6881:6881"           # swarm
      - "6881:6881/udp"
    restart: unless-stopped
    expose: ["8080"]          # NPM will reach WebUI internally
